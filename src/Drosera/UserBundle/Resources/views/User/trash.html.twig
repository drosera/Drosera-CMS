{% extends 'DroseraAdminBundle::layout.html.twig' %}

{% block content %}
    <h1>Uživatelé - koš</h1>
    {% if app.session.hasFlash('success') %}
        <div>
            {{ app.session.flash('success') }}
        </div>
    {% endif %}
    <div>
        {% render "DroseraUserBundle:User:filterMenu" with {'withTrash' : false} %}
    </div>
    {% if is_expr_granted("hasRole('ROLE_USERS_DELETE')") %} 
        {% if users | length %}
            <a href="{{ path('drosera_user_admin_user_empty_trash') }}" onclick="return confirm('Opravdu si přejete vysypat koš?');">Vysypat koš</a> 
        {% endif %}
    {% endif %}
    <table>
        <tr>
            <th>Login</th>
            <th>Jméno</th>
            <th>E-mail</th>
            <th>Uživatelská skupina</th>
            <th>Čas odstranění</th>
            {% if is_expr_granted("hasRole('ROLE_USERS_CREATE')") %}
                <th>&nbsp;</th>
            {% endif %}
            {% if is_expr_granted("hasRole('ROLE_USERS_DELETE')") %}
                <th>&nbsp;</th>
            {% endif %}
        </tr>
        {% for user in users %}
            <tr>
                <td>{{ user.username }}</td>
                <td>{{ user.fullname }}</td>
                <td>{{ user.email }}</td>
                <td>{{ user.usergroup }}</td>
                <td>{{ user.timeTrashed | date('d.m.Y H:i:s') }}</td>
                {% if is_expr_granted("hasRole('ROLE_USERS_CREATE')") %}
                    <td><a href="{{ path('drosera_user_admin_user_restore', {'id':user.id}) }}">Obnovit</a></td>
                {% endif %}    
                {% if is_expr_granted("hasRole('ROLE_USERS_DELETE')") %}
                    <td><a href="{{ path('drosera_user_admin_user_delete', {'id':user.id}) }}" onclick="return confirm('Opravdu si přejete odstranit uživatele?');">Odstranit</a></td>
                {% endif %}
            </tr>
        {% else %}
            <tr>
                <td colspan="7"><em>Koš je prázdný..</em></td>
            </tr>
        {% endfor %}
        <tr>
            <th>Login</th>
            <th>Jméno</th>
            <th>E-mail</th>
            <th>Uživatelská skupina</th>
            <th>Čas odstranění</th>
            {% if is_expr_granted("hasRole('ROLE_USERS_CREATE')") %}
                <th>&nbsp;</th>
            {% endif %}
            {% if is_expr_granted("hasRole('ROLE_USERS_DELETE')") %}
                <th>&nbsp;</th>
            {% endif %}
        </tr>
    </table>
{% endblock %}
